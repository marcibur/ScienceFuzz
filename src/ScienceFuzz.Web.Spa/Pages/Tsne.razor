@page "/TSNE"
@inject ScienceFuzzClient _httpClient
@inject IJSRuntime _js
@using System.Text
@using System.Text.Json
@using System.Text.Encodings
@using System.IO

<TsneChartDisplay Chart="Chart" />

@code
{
    public TsneChart Chart { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            //var tsne = JsonSerializer.Deserialize<TsneModel[]>("[{\"scientist\":\"naukowiec_1_KIS\",\"point\":{\"x\":89.934448639533343,\"y\":-41.116955704331204}},{\"scientist\":\"naukowiec_2_KIS\",\"point\":{\"x\":-60.779810058456277,\"y\":-59.5275637349666}},{\"scientist\":\"naukowiec_3_KIS\",\"point\":{\"x\":64.924560104402133,\"y\":128.12514569595763}},{\"scientist\":\"naukowiec_4_KIS\",\"point\":{\"x\":-21.85342077368427,\"y\":-64.970885999044128}},{\"scientist\":\"naukowiec_5_KIS\",\"point\":{\"x\":45.906607040596931,\"y\":129.127599767193}},{\"scientist\":\"naukowiec_6_KIS\",\"point\":{\"x\":-90.163086252211926,\"y\":-32.74956295055204}},{\"scientist\":\"naukowiec_7_KIS\",\"point\":{\"x\":35.062732620044216,\"y\":15.106639920679973}},{\"scientist\":\"naukowiec_8_KIS\",\"point\":{\"x\":-68.7165715570873,\"y\":-28.838454358571845}},{\"scientist\":\"naukowiec_9_KIS\",\"point\":{\"x\":36.695259401618316,\"y\":158.94488309265202}},{\"scientist\":\"naukowiec_10_KIS\",\"point\":{\"x\":-52.405933985141061,\"y\":-4.6594470724159525}},{\"scientist\":\"naukowiec_11_ICNT\",\"point\":{\"x\":53.178445638477768,\"y\":9.5029852510440946}},{\"scientist\":\"naukowiec_12_ICNT\",\"point\":{\"x\":-2.2060861710327382,\"y\":-56.738805227176719}},{\"scientist\":\"naukowiec_13_ICNT\",\"point\":{\"x\":21.089389767409905,\"y\":192.45745549437834}},{\"scientist\":\"naukowiec_14_ICNT\",\"point\":{\"x\":91.87192517658174,\"y\":-61.669252834857296}},{\"scientist\":\"naukowiec_15_ICNT\",\"point\":{\"x\":-24.451524554218476,\"y\":-103.17444958812725}},{\"scientist\":\"naukowiec_16_ICNT\",\"point\":{\"x\":-39.234414438473877,\"y\":-121.33915711993704}},{\"scientist\":\"naukowiec_17_ICNT\",\"point\":{\"x\":-94.345278614685711,\"y\":-69.403701847291785}},{\"scientist\":\"naukowiec_18_ICNT\",\"point\":{\"x\":-70.297420453157358,\"y\":-81.176062738356578}},{\"scientist\":\"naukowiec_19_ICNT\",\"point\":{\"x\":7.2566147255552726,\"y\":178.50818183441953}},{\"scientist\":\"naukowiec_20_ICNT\",\"point\":{\"x\":114.7831259070756,\"y\":-66.111188808563071}}]", new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
            //Chart = new TsneChart(tsne);
            //Console.WriteLine(JsonSerializer.Serialize(Chart, new JsonSerializerOptions { PropertyNamingPolicy = JsonNamingPolicy.CamelCase }));
            await _js.InvokeVoidAsync("loadChart", "tsneChart", Chart);
        }
    }

    protected override async Task OnInitializedAsync()
    {
        //var tsne = await _httpClient.GetTsne();
        var tsne = JsonSerializer.Deserialize<TsneModel[]>("[{\"scientist\":\"naukowiec_1_KIS\",\"point\":{\"x\":89.934448639533343,\"y\":-41.116955704331204}},{\"scientist\":\"naukowiec_2_KIS\",\"point\":{\"x\":-60.779810058456277,\"y\":-59.5275637349666}},{\"scientist\":\"naukowiec_3_KIS\",\"point\":{\"x\":64.924560104402133,\"y\":128.12514569595763}},{\"scientist\":\"naukowiec_4_KIS\",\"point\":{\"x\":-21.85342077368427,\"y\":-64.970885999044128}},{\"scientist\":\"naukowiec_5_KIS\",\"point\":{\"x\":45.906607040596931,\"y\":129.127599767193}},{\"scientist\":\"naukowiec_6_KIS\",\"point\":{\"x\":-90.163086252211926,\"y\":-32.74956295055204}},{\"scientist\":\"naukowiec_7_KIS\",\"point\":{\"x\":35.062732620044216,\"y\":15.106639920679973}},{\"scientist\":\"naukowiec_8_KIS\",\"point\":{\"x\":-68.7165715570873,\"y\":-28.838454358571845}},{\"scientist\":\"naukowiec_9_KIS\",\"point\":{\"x\":36.695259401618316,\"y\":158.94488309265202}},{\"scientist\":\"naukowiec_10_KIS\",\"point\":{\"x\":-52.405933985141061,\"y\":-4.6594470724159525}},{\"scientist\":\"naukowiec_11_ICNT\",\"point\":{\"x\":53.178445638477768,\"y\":9.5029852510440946}},{\"scientist\":\"naukowiec_12_ICNT\",\"point\":{\"x\":-2.2060861710327382,\"y\":-56.738805227176719}},{\"scientist\":\"naukowiec_13_ICNT\",\"point\":{\"x\":21.089389767409905,\"y\":192.45745549437834}},{\"scientist\":\"naukowiec_14_ICNT\",\"point\":{\"x\":91.87192517658174,\"y\":-61.669252834857296}},{\"scientist\":\"naukowiec_15_ICNT\",\"point\":{\"x\":-24.451524554218476,\"y\":-103.17444958812725}},{\"scientist\":\"naukowiec_16_ICNT\",\"point\":{\"x\":-39.234414438473877,\"y\":-121.33915711993704}},{\"scientist\":\"naukowiec_17_ICNT\",\"point\":{\"x\":-94.345278614685711,\"y\":-69.403701847291785}},{\"scientist\":\"naukowiec_18_ICNT\",\"point\":{\"x\":-70.297420453157358,\"y\":-81.176062738356578}},{\"scientist\":\"naukowiec_19_ICNT\",\"point\":{\"x\":7.2566147255552726,\"y\":178.50818183441953}},{\"scientist\":\"naukowiec_20_ICNT\",\"point\":{\"x\":114.7831259070756,\"y\":-66.111188808563071}}]", new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
        //var tsne = JsonSerializer.Deserialize<TsneModel[]>("[{\"scientist\":\"naukowiec_1_KIS\",\"point\":{\"x\":-357.76647045395811,\"y\":-250.35656151179393}},{\"scientist\":\"naukowiec_2_KIS\",\"point\":{\"x\":-16.664945692323602,\"y\":-77.720791774662274}},{\"scientist\":\"naukowiec_3_KIS\",\"point\":{\"x\":197.96687590661023,\"y\":391.25456931291035}},{\"scientist\":\"naukowiec_4_KIS\",\"point\":{\"x\":80.405559647871073,\"y\":-203.4516882075724}},{\"scientist\":\"naukowiec_5_KIS\",\"point\":{\"x\":166.95351712481471,\"y\":445.07648937406356}},{\"scientist\":\"naukowiec_6_KIS\",\"point\":{\"x\":-41.367343975007586,\"y\":59.219531182598139}},{\"scientist\":\"naukowiec_7_KIS\",\"point\":{\"x\":330.29260278234744,\"y\":-126.25149895089088}},{\"scientist\":\"naukowiec_8_KIS\",\"point\":{\"x\":17.599809258014361,\"y\":19.248701032013521}},{\"scientist\":\"naukowiec_9_KIS\",\"point\":{\"x\":66.381330486902343,\"y\":456.31682898334896}},{\"scientist\":\"naukowiec_10_KIS\",\"point\":{\"x\":112.01559425383324,\"y\":32.615268124753442}},{\"scientist\":\"naukowiec_11_ICNT\",\"point\":{\"x\":391.9815468418218,\"y\":-121.93754539958556}},{\"scientist\":\"naukowiec_12_ICNT\",\"point\":{\"x\":113.92980390743327,\"y\":-266.68929182864031}},{\"scientist\":\"naukowiec_13_ICNT\",\"point\":{\"x\":-60.899129557743535,\"y\":449.55143798762646}},{\"scientist\":\"naukowiec_14_ICNT\",\"point\":{\"x\":-330.07775644743742,\"y\":-311.6480988547579}},{\"scientist\":\"naukowiec_15_ICNT\",\"point\":{\"x\":-31.959999303856542,\"y\":-257.568634216671}},{\"scientist\":\"naukowiec_16_ICNT\",\"point\":{\"x\":-107.37681282477942,\"y\":-248.7105150089719}},{\"scientist\":\"naukowiec_17_ICNT\",\"point\":{\"x\":-128.13075173630972,\"y\":-18.114010737434857}},{\"scientist\":\"naukowiec_18_ICNT\",\"point\":{\"x\":-91.100206645558131,\"y\":-96.367306533001809}},{\"scientist\":\"naukowiec_19_ICNT\",\"point\":{\"x\":-36.745024971540957,\"y\":508.9340623905556}},{\"scientist\":\"naukowiec_20_ICNT\",\"point\":{\"x\":-387.11042101838297,\"y\":-361.90085818844352}}]");
        Chart = new TsneChart(tsne);
        //Console.WriteLine(JsonSerializer.Serialize(Chart, new JsonSerializerOptions { PropertyNamingPolicy = JsonNamingPolicy.CamelCase }));
        //await _js.InvokeVoidAsync("loadChart", "tsneChart", Chart);
    }
}